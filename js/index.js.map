{
  "version": 3,
  "sources": ["../../build/js/index.js"],
  "sourcesContent": ["const pickRandom = (arr) => arr[Math.floor(Math.random() * arr.length)];\r\n\r\nconst generators = [\r\n  { url: \"https://source.unsplash.com/800x800?people\", weight: 10 },\r\n  { url: \"https://source.unsplash.com/800x800?group\", weight: 5 },\r\n];\r\n\r\nconst unrolledGenerators = generators.flatMap(({ url, weight }) => Array(weight).fill(url));\r\n\r\nconst imageReader = new FileReader();\r\n\r\nlet currentImage = new Image();\r\n\r\nconst rerollImage = async () => {\r\n  const imageData = await fetch(pickRandom(unrolledGenerators));\r\n\r\n  return new Promise((resolve) => {\r\n    const image = new Image();\r\n\r\n    image.addEventListener(\"load\", () => {\r\n      currentImage = image;\r\n      resolve();\r\n    });\r\n\r\n    image.crossOrigin = \"anonymous\";\r\n    image.src = imageData.url;\r\n  });\r\n};\r\n\r\nconst canvas = document.getElementById(\"picture\");\r\nconst ctx = canvas.getContext(\"2d\");\r\nconst font = new FontFace(\"Bebas Neue\", \"url(public/BebasNeue-Bold.ttf)\");\r\n\r\nconst getCanvasInfo = () => {\r\n  const canvasRect = canvas.getBoundingClientRect();\r\n  return {\r\n    offsetX: canvasRect.left,\r\n    offsetY: canvasRect.top,\r\n    canvasScale: canvasRect.width / 800,\r\n  };\r\n};\r\n\r\nlet { offsetX, offsetY, canvasScale } = getCanvasInfo();\r\n\r\nlet isDragging = false;\r\nlet startX;\r\nlet startY;\r\n\r\nconst overlayImage = new Image();\r\noverlayImage.src = \"public/janecek.png\";\r\nconst initialWidth = 493;\r\nconst initialHeight = 897;\r\nconst descale = 1.8;\r\nconst overlayImageCoords = {\r\n  x: 500,\r\n  y: 800 - (initialHeight / descale),\r\n  width: initialWidth / descale,\r\n  height: initialHeight / descale,\r\n};\r\n\r\nconst onMouseDown = (e) => {\r\n  const isTouch = !!e.touches;\r\n  // mouse position\r\n  const mx = Number((isTouch ? e.touches[0].clientX : e.clientX) - offsetX);\r\n  const my = Number((isTouch ? e.touches[0].clientY : e.clientY) - offsetY);\r\n\r\n  // overlay image position (with scaling)\r\n  const ix = overlayImageCoords.x * canvasScale;\r\n  const iy = overlayImageCoords.y * canvasScale;\r\n  const iw = overlayImageCoords.width * canvasScale;\r\n  const ih = overlayImageCoords.height * canvasScale;\r\n\r\n  if (mx > ix && mx < ix + iw && my > iy && my < iy + ih) {\r\n    isDragging = true;\r\n  }\r\n\r\n  startX = mx;\r\n  startY = my;\r\n};\r\n\r\ncanvas.addEventListener(\"mousedown\", onMouseDown);\r\ncanvas.addEventListener(\"touchstart\", onMouseDown);\r\n\r\ncanvas.addEventListener(\"mouseup\", () => { isDragging = false; });\r\n\r\nconst initFont = async () => {\r\n  await font.load();\r\n  document.fonts.add(font);\r\n};\r\n\r\nconst setFile = (file) => {\r\n  if (!file.type.startsWith(\"image/\")) {\r\n    return;\r\n  }\r\n\r\n  imageReader.readAsDataURL(file);\r\n};\r\n\r\ncanvas.addEventListener(\"dragover\", (e) => e.preventDefault());\r\n\r\ncanvas.addEventListener(\"drop\", (e) => {\r\n  e.preventDefault();\r\n  if (!e.dataTransfer || e.dataTransfer.files.length <= 0) {\r\n    return;\r\n  }\r\n\r\n  setFile(e.dataTransfer.files[0]);\r\n});\r\n\r\nconst repaintImage = async () => {\r\n  // clear to black (for transparent images)\r\n  ctx.fillStyle = \"black\";\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n  // scale image to always fill the canvas\r\n  const scaleX = canvas.width / currentImage.width;\r\n  const scaleY = canvas.height / currentImage.height;\r\n  const scale = Math.max(scaleX, scaleY);\r\n  ctx.setTransform(scale, 0, 0, scale, 0, 0);\r\n  ctx.drawImage(currentImage, 0, 0);\r\n  ctx.setTransform(); // reset so that everything else is normal size\r\n\r\n  ctx.drawImage(overlayImage, overlayImageCoords.x, overlayImageCoords.y, overlayImageCoords.width, overlayImageCoords.height);\r\n\r\n  /*\r\n  const lines = splitText(currentText, 20).reverse();\r\n  const fontSize = lines.length < 5 ? 60 : 40;\r\n  ctx.font = `${fontSize}px 'Bebas Neue'`;\r\n  lines.forEach((line, index) => {\r\n    const x = 30;\r\n    const y = 685;\r\n    const padding = 15;\r\n    const lineHeight = padding + fontSize;\r\n    ctx.fillStyle = \"#f9dc4d\";\r\n    ctx\r\n      .fillRect(x, y - (index * lineHeight), ctx.measureText(line).width + 2 * padding, lineHeight);\r\n    ctx.textBaseline = \"top\";\r\n    ctx.fillStyle = \"black\";\r\n    ctx.fillText(line, x + padding, y + padding - (index * lineHeight));\r\n  });\r\n  */\r\n};\r\n\r\nconst onMove = (e) => {\r\n  const isTouch = !!e.touches;\r\n  // mouse position\r\n  const mx = Number((isTouch ? e.touches[0].clientX : e.clientX) - offsetX);\r\n  const my = Number((isTouch ? e.touches[0].clientY : e.clientY) - offsetY);\r\n  //console.log(mx, my, isDragging)\r\n\r\n  // overlay image position (with scaling)\r\n  const ix = overlayImageCoords.x * canvasScale;\r\n  const iy = overlayImageCoords.y * canvasScale;\r\n  const iw = overlayImageCoords.width * canvasScale;\r\n  const ih = overlayImageCoords.height * canvasScale;\r\n\r\n  // fancy cursor\r\n  if (mx > ix && mx < ix + iw && my > iy && my < iy + ih) {\r\n    canvas.style.cursor = \"pointer\";\r\n  } else {\r\n    canvas.style.cursor = \"initial\";\r\n  }\r\n\r\n  if (isDragging) {\r\n    // calculate the distance the mouse has moved\r\n    // since the last mousemove\r\n    const dx = mx - startX;\r\n    const dy = my - startY;\r\n\r\n    overlayImageCoords.x += dx / canvasScale;\r\n    overlayImageCoords.y += dy / canvasScale;\r\n\r\n    repaintImage();\r\n\r\n    // reset the starting mouse position for the next mousemove\r\n    startX = mx;\r\n    startY = my;\r\n  }\r\n};\r\n\r\ncanvas.addEventListener(\"mousemove\", onMove);\r\ncanvas.addEventListener(\"touchmove\", onMove);\r\n\r\nimageReader.addEventListener(\"load\", (e) => {\r\n  currentImage = new Image();\r\n  currentImage.addEventListener(\"load\", () => repaintImage());\r\n  currentImage.src = e.target.result;\r\n});\r\n\r\nconst buttonRandomImg = document.getElementById(\"randomize\");\r\nbuttonRandomImg.addEventListener(\"click\", async () => {\r\n  await rerollImage();\r\n  repaintImage();\r\n});\r\n\r\nconst inputCustomImg = document.getElementById(\"customImage\");\r\ninputCustomImg.addEventListener(\"change\", (e) => {\r\n  e.preventDefault();\r\n  if (e.target.files.length <= 0) {\r\n    return;\r\n  }\r\n  setFile(e.target.files[0]);\r\n});\r\nconst buttonCustomImg = document.getElementById(\"customImageBtn\");\r\nbuttonCustomImg.addEventListener(\"click\", () => {\r\n  inputCustomImg.click();\r\n});\r\n\r\nconst inputCustom = document.getElementById(\"customText\");\r\nconst replaceWithCustomText = async (e) => {\r\n  if (e.type === \"input\" || inputCustom.value) {\r\n    currentText = inputCustom.value;\r\n    repaintImage();\r\n  }\r\n};\r\ninputCustom.addEventListener(\"click\", replaceWithCustomText);\r\ninputCustom.addEventListener(\"input\", replaceWithCustomText);\r\n\r\nconst slider = document.getElementById(\"slider\");\r\nconst moveSlider = (value) => {\r\n  overlayImageCoords.width = initialWidth * (value / 100);\r\n  overlayImageCoords.height = initialHeight * (value / 100);\r\n  repaintImage();\r\n};\r\nslider.addEventListener(\"input\", (e) => moveSlider(e.target.value));\r\n\r\nconst downloadLinkReal = document.createElement(\"a\");\r\ndownloadLinkReal.setAttribute(\"download\", \"TohleJsmeMy.jpg\");\r\nconst linkSave = document.getElementById(\"save\");\r\nlinkSave.addEventListener(\"click\", (e) => {\r\n  e.preventDefault();\r\n  downloadLinkReal.setAttribute(\"href\", canvas.toDataURL(\"image/jpeg\").replace(\"image/jpeg\", \"image/octet-stream\"));\r\n  downloadLinkReal.click();\r\n});\r\n\r\nwindow.addEventListener(\"resize\", () => {\r\n  const resizedCanvasInfo = getCanvasInfo();\r\n  offsetX = resizedCanvasInfo.offsetX;\r\n  offsetY = resizedCanvasInfo.offsetY;\r\n  canvasScale = resizedCanvasInfo.canvasScale;\r\n});\r\n\r\ninitFont();\r\n\r\nrerollImage()\r\n  .then(() => repaintImage());\r\n\r\n// /////////////////////\r\n// Log events flag\r\n\r\n// Global vars to cache event state\r\nvar evCache = [{ clientX: 0 }];\r\nvar prevDiff = -1;\r\n\r\nfunction clearLog(event) {\r\n  var o = document.getElementsByTagName('output')[0];\r\n  o.innerHTML = \"\";\r\n}\r\n\r\nfunction pointerdown_handler(ev) {\r\n  console.log(\"pd\")\r\n  // The pointerdown event signals the start of a touch interaction.\r\n  // This event is cached to support 2-finger gestures\r\n  evCache.push(ev);\r\n}\r\n\r\nfunction pointermove_handler(ev) {\r\n  // This function implements a 2-pointer horizontal pinch/zoom gesture. \r\n  //\r\n  // If the distance between the two pointers has increased (zoom in), \r\n  // the taget element's background is changed to \"pink\" and if the \r\n  // distance is decreasing (zoom out), the color is changed to \"lightblue\".\r\n  //\r\n  // This function sets the target element's border to \"dashed\" to visually\r\n  // indicate the pointer's target received a move event.\r\n  ev.target.style.border = \"dashed\";\r\n  console.log(evCache)\r\n\r\n  // Find this event in the cache and update its record with this event\r\n  for (var i = 0; i < evCache.length; i++) {\r\n    if (ev.pointerId == evCache[i].pointerId) {\r\n      evCache[i] = ev;\r\n      break;\r\n    }\r\n  }\r\n\r\n  // If two pointers are down, check for pinch gestures\r\n  if (evCache.length == 2) {\r\n    // Calculate the distance between the two pointers\r\n    var curDiff = Math.abs(evCache[0].clientX - evCache[1].clientX);\r\n    const slider = document.getElementById(\"slider\");\r\n\r\n    if (prevDiff > 0) {\r\n      if (curDiff > prevDiff) {\r\n        // The distance between the two pointers has increased\r\n        console.log(\"Pinch moving OUT -> Zoom in\", ev);\r\n        slider.value = Number(slider.value) + 1;\r\n        moveSlider(slider.value);\r\n      }\r\n      if (curDiff < prevDiff) {\r\n        // The distance between the two pointers has decreased\r\n        console.log(\"Pinch moving IN -> Zoom out\", ev);\r\n        slider.value = Number(slider.value) - 1;\r\n        moveSlider(slider.value);\r\n      }\r\n    }\r\n\r\n    // Cache the distance for the next move event \r\n    prevDiff = curDiff;\r\n  }\r\n}\r\n\r\nfunction pointerup_handler(ev) {\r\n  console.log(\"pup\")\r\n  // Remove this pointer from the cache and reset the target's\r\n  // background and border\r\n  remove_event(ev);\r\n  ev.target.style.background = \"white\";\r\n  ev.target.style.border = \"1px solid black\";\r\n\r\n  // If the number of pointers down is less than two then reset diff tracker\r\n  if (evCache.length < 2) prevDiff = -1;\r\n}\r\n\r\nfunction remove_event(ev) {\r\n  // Remove this event from the target's cache\r\n  for (var i = 0; i < evCache.length; i++) {\r\n    if (evCache[i].pointerId == ev.pointerId) {\r\n      evCache.splice(i, 1);\r\n      break;\r\n    }\r\n  }\r\n}\r\n\r\nfunction init() {\r\n  // Install event handlers for the pointer target\r\n  var el = canvas;\r\n  el.onpointerdown = pointerdown_handler;\r\n  el.onpointermove = pointermove_handler;\r\n\r\n  // Use same handler for pointer{up,cancel,out,leave} events since\r\n  // the semantics for these events - in this app - are the same.\r\n  el.onpointerup = pointerup_handler;\r\n  el.onpointercancel = pointerup_handler;\r\n  el.onpointerout = pointerup_handler;\r\n  el.onpointerleave = pointerup_handler;\r\n}\r\ninit();\r\n// /////////////////////\r\n"],
  "mappings": "AAAA,GAAM,GAAa,AAAC,GAAQ,EAAI,KAAK,MAAM,KAAK,SAAW,EAAI,SAEzD,EAAa,CACjB,CAAE,IAAK,6CAA8C,OAAQ,IAC7D,CAAE,IAAK,4CAA6C,OAAQ,IAGxD,EAAqB,EAAW,QAAQ,CAAC,CAAE,MAAK,YAAa,MAAM,GAAQ,KAAK,IAEhF,EAAc,GAAI,YAEpB,EAAe,GAAI,OAEjB,EAAc,SAAY,CAC9B,GAAM,GAAY,KAAM,OAAM,EAAW,IAEzC,MAAO,IAAI,SAAQ,AAAC,GAAY,CAC9B,GAAM,GAAQ,GAAI,OAElB,EAAM,iBAAiB,OAAQ,IAAM,CACnC,EAAe,EACf,MAGF,EAAM,YAAc,YACpB,EAAM,IAAM,EAAU,OAIpB,EAAS,SAAS,eAAe,WACjC,EAAM,EAAO,WAAW,MACxB,EAAO,GAAI,UAAS,aAAc,kCAElC,EAAgB,IAAM,CAC1B,GAAM,GAAa,EAAO,wBAC1B,MAAO,CACL,QAAS,EAAW,KACpB,QAAS,EAAW,IACpB,YAAa,EAAW,MAAQ,MAIhC,CAAE,UAAS,UAAS,eAAgB,IAEpC,EAAa,GACb,EACA,EAEE,EAAe,GAAI,OACzB,EAAa,IAAM,qBACnB,GAAM,GAAe,IACf,EAAgB,IAChB,EAAU,IACV,EAAqB,CACzB,EAAG,IACH,EAAG,IAAO,EAAgB,EAC1B,MAAO,EAAe,EACtB,OAAQ,EAAgB,GAGpB,EAAc,AAAC,GAAM,CACzB,GAAM,GAAU,CAAC,CAAC,EAAE,QAEd,EAAK,OAAQ,GAAU,EAAE,QAAQ,GAAG,QAAU,EAAE,SAAW,GAC3D,EAAK,OAAQ,GAAU,EAAE,QAAQ,GAAG,QAAU,EAAE,SAAW,GAG3D,EAAK,EAAmB,EAAI,EAC5B,EAAK,EAAmB,EAAI,EAC5B,EAAK,EAAmB,MAAQ,EAChC,EAAK,EAAmB,OAAS,EAEvC,AAAI,EAAK,GAAM,EAAK,EAAK,GAAM,EAAK,GAAM,EAAK,EAAK,GAClD,GAAa,IAGf,EAAS,EACT,EAAS,GAGX,EAAO,iBAAiB,YAAa,GACrC,EAAO,iBAAiB,aAAc,GAEtC,EAAO,iBAAiB,UAAW,IAAM,CAAE,EAAa,KAExD,GAAM,GAAW,SAAY,CAC3B,KAAM,GAAK,OACX,SAAS,MAAM,IAAI,IAGf,EAAU,AAAC,GAAS,CACxB,AAAI,CAAC,EAAK,KAAK,WAAW,WAI1B,EAAY,cAAc,IAG5B,EAAO,iBAAiB,WAAY,AAAC,GAAM,EAAE,kBAE7C,EAAO,iBAAiB,OAAQ,AAAC,GAAM,CAErC,AADA,EAAE,iBACE,GAAC,EAAE,cAAgB,EAAE,aAAa,MAAM,QAAU,IAItD,EAAQ,EAAE,aAAa,MAAM,MAG/B,GAAM,GAAe,SAAY,CAE/B,EAAI,UAAY,QAChB,EAAI,SAAS,EAAG,EAAG,EAAO,MAAO,EAAO,QAGxC,GAAM,GAAS,EAAO,MAAQ,EAAa,MACrC,EAAS,EAAO,OAAS,EAAa,OACtC,EAAQ,KAAK,IAAI,EAAQ,GAC/B,EAAI,aAAa,EAAO,EAAG,EAAG,EAAO,EAAG,GACxC,EAAI,UAAU,EAAc,EAAG,GAC/B,EAAI,eAEJ,EAAI,UAAU,EAAc,EAAmB,EAAG,EAAmB,EAAG,EAAmB,MAAO,EAAmB,SAqBjH,EAAS,AAAC,GAAM,CACpB,GAAM,GAAU,CAAC,CAAC,EAAE,QAEd,EAAK,OAAQ,GAAU,EAAE,QAAQ,GAAG,QAAU,EAAE,SAAW,GAC3D,EAAK,OAAQ,GAAU,EAAE,QAAQ,GAAG,QAAU,EAAE,SAAW,GAI3D,EAAK,EAAmB,EAAI,EAC5B,EAAK,EAAmB,EAAI,EAC5B,EAAK,EAAmB,MAAQ,EAChC,EAAK,EAAmB,OAAS,EASvC,GANA,AAAI,EAAK,GAAM,EAAK,EAAK,GAAM,EAAK,GAAM,EAAK,EAAK,EAClD,EAAO,MAAM,OAAS,UAEtB,EAAO,MAAM,OAAS,UAGpB,EAAY,CAGd,GAAM,GAAK,EAAK,EACV,EAAK,EAAK,EAEhB,EAAmB,GAAK,EAAK,EAC7B,EAAmB,GAAK,EAAK,EAE7B,IAGA,EAAS,EACT,EAAS,IAIb,EAAO,iBAAiB,YAAa,GACrC,EAAO,iBAAiB,YAAa,GAErC,EAAY,iBAAiB,OAAQ,AAAC,GAAM,CAC1C,EAAe,GAAI,OACnB,EAAa,iBAAiB,OAAQ,IAAM,KAC5C,EAAa,IAAM,EAAE,OAAO,SAG9B,GAAM,GAAkB,SAAS,eAAe,aAChD,EAAgB,iBAAiB,QAAS,SAAY,CACpD,KAAM,KACN,MAGF,GAAM,GAAiB,SAAS,eAAe,eAC/C,EAAe,iBAAiB,SAAU,AAAC,GAAM,CAE/C,AADA,EAAE,iBACE,IAAE,OAAO,MAAM,QAAU,IAG7B,EAAQ,EAAE,OAAO,MAAM,MAEzB,GAAM,GAAkB,SAAS,eAAe,kBAChD,EAAgB,iBAAiB,QAAS,IAAM,CAC9C,EAAe,UAGjB,GAAM,GAAc,SAAS,eAAe,cACtC,EAAwB,KAAO,IAAM,CACzC,AAAI,GAAE,OAAS,SAAW,EAAY,QACpC,aAAc,EAAY,MAC1B,MAGJ,EAAY,iBAAiB,QAAS,GACtC,EAAY,iBAAiB,QAAS,GAEtC,GAAM,GAAS,SAAS,eAAe,UACjC,EAAa,AAAC,GAAU,CAC5B,EAAmB,MAAQ,EAAgB,GAAQ,KACnD,EAAmB,OAAS,EAAiB,GAAQ,KACrD,KAEF,EAAO,iBAAiB,QAAS,AAAC,GAAM,EAAW,EAAE,OAAO,QAE5D,GAAM,GAAmB,SAAS,cAAc,KAChD,EAAiB,aAAa,WAAY,mBAC1C,GAAM,GAAW,SAAS,eAAe,QACzC,EAAS,iBAAiB,QAAS,AAAC,GAAM,CACxC,EAAE,iBACF,EAAiB,aAAa,OAAQ,EAAO,UAAU,cAAc,QAAQ,aAAc,uBAC3F,EAAiB,UAGnB,OAAO,iBAAiB,SAAU,IAAM,CACtC,GAAM,GAAoB,IAC1B,EAAU,EAAkB,QAC5B,EAAU,EAAkB,QAC5B,EAAc,EAAkB,cAGlC,IAEA,IACG,KAAK,IAAM,KAMd,GAAI,GAAU,CAAC,CAAE,QAAS,IACtB,EAAW,GAOf,WAA6B,EAAI,CAC/B,QAAQ,IAAI,MAGZ,EAAQ,KAAK,GAGf,WAA6B,EAAI,CAS/B,EAAG,OAAO,MAAM,OAAS,SACzB,QAAQ,IAAI,GAGZ,OAAS,GAAI,EAAG,EAAI,EAAQ,OAAQ,IAClC,GAAI,EAAG,WAAa,EAAQ,GAAG,UAAW,CACxC,EAAQ,GAAK,EACb,MAKJ,GAAI,EAAQ,QAAU,EAAG,CAEvB,GAAI,GAAU,KAAK,IAAI,EAAQ,GAAG,QAAU,EAAQ,GAAG,SACvD,GAAM,GAAS,SAAS,eAAe,UAEvC,AAAI,EAAW,GACT,GAAU,GAEZ,SAAQ,IAAI,8BAA+B,GAC3C,EAAO,MAAQ,OAAO,EAAO,OAAS,EACtC,EAAW,EAAO,QAEhB,EAAU,GAEZ,SAAQ,IAAI,8BAA+B,GAC3C,EAAO,MAAQ,OAAO,EAAO,OAAS,EACtC,EAAW,EAAO,SAKtB,EAAW,GAIf,WAA2B,EAAI,CAC7B,QAAQ,IAAI,OAGZ,EAAa,GACb,EAAG,OAAO,MAAM,WAAa,QAC7B,EAAG,OAAO,MAAM,OAAS,kBAGrB,EAAQ,OAAS,GAAG,GAAW,IAGrC,WAAsB,EAAI,CAExB,OAAS,GAAI,EAAG,EAAI,EAAQ,OAAQ,IAClC,GAAI,EAAQ,GAAG,WAAa,EAAG,UAAW,CACxC,EAAQ,OAAO,EAAG,GAClB,OAKN,YAAgB,CAEd,GAAI,GAAK,EACT,EAAG,cAAgB,EACnB,EAAG,cAAgB,EAInB,EAAG,YAAc,EACjB,EAAG,gBAAkB,EACrB,EAAG,aAAe,EAClB,EAAG,eAAiB,EAEtB",
  "names": []
}
